<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3. Trial Schema (stimuli.jsonl)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        table { width: 100%; border-collapse: collapse; margin-top: 1.5rem; margin-bottom: 1.5rem; }
        th, td { border: 1px solid #e2e8f0; padding: 0.75rem 1rem; text-align: left; vertical-align: top; }
        th { background-color: #f8fafc; font-weight: 600; }
        pre { background-color: #f1f5f9; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin-top: 1rem; margin-bottom: 1rem; }
        code { font-family: 'Courier New', Courier, monospace; }
        input[type="range"] { -webkit-appearance: none; appearance: none; width: 100%; height: 8px; background: #d1d5db; outline: none; opacity: 0.7; transition: opacity .2s; border-radius: 4px; }
        input[type="range"]:hover { opacity: 1; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 20px; height: 20px; border-radius: 50%; background: #3b82f6; cursor: pointer; margin-top: -6px; border: 2px solid #fff; box-shadow: 0 0 0 1px rgba(0,0,0,0.1); }
        input[type="range"]::-moz-range-thumb { width: 20px; height: 20px; border-radius: 50%; background: #3b82f6; cursor: pointer; border: none; }
        .slider-wrapper { position: relative; padding-bottom: 2rem; }
        .slider-labels { position: absolute; width: 100%; display: flex; justify-content: space-between; top: calc(100% - 1.5rem); }
        .slider-label-item { position: absolute; font-size: 0.875rem; color: #4b5563; white-space: nowrap; }
        .prose h1 { font-size: 2.25rem; font-weight: 700; margin-bottom: 1.5rem; border-bottom: 1px solid #e2e8f0; padding-bottom: 0.5rem; }
        .prose h2 { font-size: 1.875rem; font-weight: 600; margin-top: 2.5rem; margin-bottom: 1rem; border-bottom: 1px solid #e2e8f0; padding-bottom: 0.5rem; }
        .prose h3 { font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 1rem; }
        .prose h4 { font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
        .prose p, .prose ul { margin-bottom: 1.25rem; line-height: 1.75; }
        .prose a { color: #2563eb; text-decoration: none; font-weight: 500; }
        .prose a:hover { text-decoration: underline; }
        .required-asterisk { color: #dc2626; }
        .sidebar { width: 250px; position: fixed; left: 0; top: 0; height: 100vh; overflow-y: auto; background-color: #1f2937; }
        .content-wrapper { margin-left: 250px; }
        .nav-link { display: block; padding: 0.75rem 1.5rem; color: #d1d5db; text-decoration: none; border-left: 3px solid transparent; }
        .nav-link:hover { background-color: #374151; color: white; }
        .nav-link.active { background-color: #374151; color: white; border-left-color: #3b82f6; font-weight: 600; }
        @media (max-width: 768px) {
            .sidebar { width: 100%; height: auto; position: relative; }
            .content-wrapper { margin-left: 0; }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 antialiased">

    <nav class="sidebar">
        <div class="py-4">
            <a href="overview.html" class="nav-link">1. Overview</a>
            <a href="config_schema.html" class="nav-link">2. Config Schema (config.json)</a>
            <a href="trial_schema.html" class="nav-link active">3. Trial Schema (stimuli.jsonl)</a>
            <a href="instruction_schema.html" class="nav-link">4. Instruction Schema</a>
            <a href="human_data_schema.html" class="nav-link">5. Human Data Schema</a>
        </div>
    </nav>

    <div class="content-wrapper">
    <div class="container mx-auto max-w-4xl p-6 md:p-12 bg-white shadow-lg rounded-lg my-12 prose prose-lg">

        <h1>3. File Specification: Trial Schema (stimuli.jsonl)</h1>
        <p>This document details the JSON schema for defining individual experimental trials. In the directory structure, this file is named <code>stimuli.jsonl</code>.</p>
        <p>Each JSON object represents one "trial" which presents a stimulus (like an image or video) and then asks the user one or more questions about it. The <code>stimuli.jsonl</code> file contains one JSON object per line.</p>
        
        <h2 id="top-level-fields">3.1. Top-Level Fields (Single Trial)</h2>
        <p>The root object of a single trial contains the following key properties:</p>
        <div class="overflow-x-auto">
            <table>
                <thead>
                    <tr>
                        <th>Key</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>stimuli_id</code></td>
                        <td>String</td>
                        <td>A unique identifier for this specific trial or stimulus (e.g., "trial_005"). This ID is used in the <code>config.json</code> file.</td>
                    </tr>
                    <tr>
                        <td><code>input_type</code></td>
                        <td>String</td>
                        <td>Specifies the type of media to be presented. Common values include "img", "video", or "text".</td>
                    </tr>
                    <tr>
                        <td><code>media_url</code></td>
                        <td>Array of Strings</td>
                        <td>An array containing one or more paths to the media files (relative to the <code>assets/</code> folder). Even if there is only one item, it should be in an array.</td>
                    </tr>
                    <tr>
                        <td><code>commentary</code></td>
                        <td>String</td>
                        <td>An optional field for any text that should be displayed alongside or before the stimulus. Can be left empty (<code>""</code>).</td>
                    </tr>
                    <tr>
                        <td><code>queries</code></td>
                        <td>Array of Objects</td>
                        <td>This is the most important part. It's an array where each object represents a single question or prompt for the user. See <strong><a href="#queries">Section 3.2</a></strong> below for details.</td>
                    </tr>
                    <tr>
                        <td><code>delay</code></td>
                        <td>Number</td>
                        <td>Optional. If specified, delays the display of the queries by N milliseconds after the stimulus is shown. Useful for controlling pacing in experiments.</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3>3.1.1. Full Trial Object Example</h3>
        <p>Here is an example of a complete trial object that shows an image and asks two questions: one multiple-choice and one slider.</p>
        <pre><code>{
  "stimuli_id": "trial_agent_01",
  "input_type": "img",
  "media_url": [
    "https://placehold.co/600x400/e2e8f0/334155?text=Example+Stimulus+Image"
  ],
  "commentary": "Observe the agent's action in the image above.",
  "queries": [
    {
      "prompt": "What is the agent's primary goal?",
      "type": "multi-choice",
      "tag": "agent_goal",
      "option": [
        "Reaching the red box",
        "Reaching the blue box",
        "Looking for a key"
      ],
      "randomize_order": false,
      "required": true
    },
    {
      "prompt": "How confident are you in your answer?",
      "type": "single-slider",
      "tag": "goal_confidence",
      "slider_config": {
        "min": 0,
        "max": 100,
        "default_value": 50,
        "labels": [
          { "value": 0, "label": "Not at all confident" },
          { "value": 100, "label": "Completely confident" }
        ],
        "show_label_values": true
      },
      "randomize_order": false,
      "required": true
    }
  ]
}</code></pre>

        <h3>3.1.2. Live Demo of Full Trial</h3>
        <div class="rendered-example bg-gray-100 p-4 rounded-md mb-8 border border-gray-200 not-prose">
            <img src="https://placehold.co/600x400/e2e8f0/334155?text=Example+Stimulus+Image" alt="Example Stimulus" class="w-full max-w-lg mx-auto rounded-md shadow-sm mb-4">
            <p class="text-base text-gray-700 italic text-center mb-6">Observe the agent's action in the image above.</p>
            
            <div class="bg-white p-4 rounded-md shadow-inner">
                <div class="mb-6">
                    <p class="font-medium mb-3 text-gray-900">What is the agent's primary goal?<span class="required-asterisk">*</span></p>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="radio" name="agent-goal" class="form-radio text-blue-600 h-5 w-5">
                            <span class="ml-2 text-gray-700">Reaching the red box</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="agent-goal" class="form-radio text-blue-600 h-5 w-5">
                            <span class="ml-2 text-gray-700">Reaching the blue box</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="agent-goal" class="form-radio text-blue-600 h-5 w-5">
                            <span class="ml-2 text-gray-700">Looking for a key</span>
                        </label>
                    </div>
                </div>
                <div>
                    <p class="font-medium mb-3 text-gray-900">How confident are you in your answer?<span class="required-asterisk">*</span>: <span id="single-slider-val-demo" class="font-semibold">50</span></p>
                    <div class="slider-wrapper">
                        <input type="range" min="0" max="100" value="50" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer" oninput="document.getElementById('single-slider-val-demo').innerText = this.value">
                        <div class="slider-labels" style="position: relative; top: 0.5rem; height: auto;">
                            <span class="slider-label-item" style="left: 0%; transform: translateX(0%);">Not at all confident</span>
                            <span class="slider-label-item" style="left: 100%; transform: translateX(-100%);">Completely confident</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <h2 id="queries">3.2. Query Object Schema</h2>
        <p>The <code>queries</code> array contains objects that define each question. All query objects share these common fields:</p>
        <div class="overflow-x-auto">
            <table>
                <thead>
                    <tr>
                        <th>Key</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>prompt</code></td>
                        <td>String</td>
                        <td>The question text presented to the user (e.t., "What is the agent's goal?").</td>
                    </tr>
                    <tr>
                        <td><code>type</code></td>
                        <td>String</td>
                        <td>The type of response widget to display. See <strong><a href="#query-types">Section 3.2.1</a></strong> for options.</td>
                    </tr>
                    <tr>
                        <td><code>tag</code></td>
                        <td>String</td>
                        <td>A unique, computer-friendly key for this query (e.g., "agent_goal"). Used to store data.</td>
                    </tr>
                    <tr>
                        <td><code>option</code></td>
                        <td>Array of Strings</td>
                        <td>A list of choices. Used for <code>multi-choice</code>, <code>multi-select</code>, and <code>multi-slider</code>.</td>
                    </tr>
                    <tr>
                        <td><code>randomize_order</code></td>
                        <td>Boolean</td>
                        <td>If <code>true</code>, the order of items in the <code>option</code> array will be shuffled for each participant.</td>
                    </tr>
                    <tr>
                        <td><code>slider_config</code></td>
                        <td>Object</td>
                        <td>Required <em>only</em> if <code>type</code> is "single-slider" or "multi-slider". See <strong><a href="#slider-config">Section 3.2.2</a></strong>.</td>
                    </tr>
                    <tr>
                        <td><code>sampling_size</code></td>
                        <td>Number</td>
                        <td>Optional. Applies <em>only</em> to <code>multi-slider</code>. If specified, only a random subset of <code>option</code> items (of size <code>sampling_size</code>) will be shown to each participant. Used for reducing cognitive load when there are many statements to rate.</td>
                    </tr>
                    <tr>
                        <td><code>required</code></td>
                        <td>Boolean</td>
                        <td>Optional. If <code>true</code>, the user must provide a response to this query before proceeding. Default is <code>false</code> if not specified.</td>
                    </tr>
                    <tr>
                        <td><code>answer</code></td>
                        <td>Number</td>
                        <td>Optional. The 0-based index of the correct option in the <code>option</code> array. Used for providing feedback in comprehension quizzes or test trials.</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3 id="query-types">3.2.1. Query Types (<code>type</code>)</h3>
        <p>This section details the different response widgets available.</p>
        
        <h4 class="prose">3.2.1.1. multi-choice</h4>
        <p class="prose">Presents a list of radio buttons from the <code>option</code> array. The user can select only one.</p>
        <h5 class="text-base font-semibold text-gray-600 mt-4 mb-2">JSON Example:</h5>
        <pre><code>{
  "prompt": "What is the capital of France?",
  "type": "multi-choice",
  "tag": "capital_choice",
  "option": [
    "London",
    "Berlin",
    "Paris",
    "Madrid"
  ],
  "randomize_order": true,
  "required": true
}
// Data would be saved as: "capital_choice": { "idx": 2, "option_text": "Paris" }</code></pre>
        <h5 class="text-base font-semibold text-gray-600 mt-4 mb-2">Live Demo:</h5>
        <div class="rendered-example bg-gray-100 p-4 rounded-md mb-8 border border-gray-200 not-prose">
            <p class="font-medium mb-3">What is the capital of France?<span class="required-asterisk">*</span></p>
            <div class="space-y-2">
                <label class="flex items-center">
                    <input type="radio" name="capital-choice" class="form-radio text-blue-600 h-5 w-5">
                    <span class="ml-2 text-gray-700">London</span>
                </label>
                <label class="flex items-center">
                    <input type="radio" name="capital-choice" class="form-radio text-blue-600 h-5 w-5">
                    <span class="ml-2 text-gray-700">Berlin</span>
                </label>
                <label class="flex items-center">
                    <input type="radio" name="capital-choice" class="form-radio text-blue-600 h-5 w-5">
                    <span class="ml-2 text-gray-700">Paris</span>
                </label>
                <label class="flex items-center">
                    <input type="radio" name="capital-choice" class="form-radio text-blue-600 h-5 w-5">
                    <span class="ml-2 text-gray-700">Madrid</span>
                </label>
            </div>
        </div>

        <h4 class="prose">3.2.1.2. multi-select</h4>
        <p class="prose">Presents a list of checkboxes from the <code>option</code> array. The user can select one or more.</p>
        <h5 class="text-base font-semibold text-gray-600 mt-4 mb-2">JSON Example:</h5>
        <pre><code>{
  "prompt": "Which colors do you see?",
  "type": "multi-select",
  "tag": "color_select",
  "option": [ "Red", "Green", "Blue" ],
  "randomize_order": false,
  "required": true
}
// Data would be saved as: "color_select": [
//   { "idx": 0, "option_text": "Red" },
//   { "idx": 2, "option_text": "Blue" }
// ]</code></pre>

        <h4 class="prose">3.2.1.3. single-slider</h4>
        <p class="prose">Presents a single slider. Requires <code>slider_config</code>. The <code>option</code> field is not used.</p>
        <h5 class="text-base font-semibold text-gray-600 mt-4 mb-2">JSON Example:</h5>
        <pre><code>{
  "prompt": "How confident are you?",
  "type": "single-slider",
  "tag": "confidence_rating",
  "slider_config": {
    "min": 0,
    "max": 100,
    "default_value": 50,
    "labels": [
      { "value": 0, "label": "Not at all" },
      { "value": 100, "label": "Completely" }
    ],
    "show_label_values": true
  },
  "required": true
}
// Data would be saved as: "confidence_rating": 78</code></pre>
        <h5 class="text-base font-semibold text-gray-600 mt-4 mb-2">Live Demo:</h5>
        <div class="rendered-example bg-gray-100 p-4 rounded-md mb-8 border border-gray-200 not-prose">
            <p class="font-medium mb-3 text-gray-900">How confident are you?<span class="required-asterisk">*</span>: <span id="single-slider-val-demo-2" class="font-semibold">50</span></p>
            <div class="slider-wrapper">
                <input type="range" min="0" max="100" value="50" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer" oninput="document.getElementById('single-slider-val-demo-2').innerText = this.value">
                <div class="slider-labels" style="position: relative; top: 0.5rem; height: auto;">
                    <span class="slider-label-item" style="left: 0%; transform: translateX(0%);">0<br>Not at all</span>
                    <span class="slider-label-item" style="left: 100%; transform: translateX(-100%);">100<br>Completely</span>
                </div>
            </div>
        </div>

        <h4 class="prose">3.2.1.4. multi-slider</h4>
        <p class="prose">Presents one slider for each item in the <code>option</code> array. Requires <code>slider_config</code>. Optionally, you can use <code>sampling_size</code> to show only a random subset of options to reduce cognitive load.</p>
        <h5 class="text-base font-semibold text-gray-600 mt-4 mb-2">JSON Example:</h5>
        <pre><code>{
  "prompt": "Please rate how likely each of the following statements is to be true",
  "type": "multi-slider",
  "tag": "statement_ratings",
  "option": [
    "Statement 1",
    "Statement 2",
    "Statement 3"
  ],
  "slider_config": {
    "min": 0,
    "max": 100,
    "default_value": 50,
    "labels": [
      { "value": 0, "label": "Extremely unlikely" },
      { "value": 50, "label": "Neutral" },
      { "value": 100, "label": "Extremely likely" }
    ],
    "show_label_values": true
  },
  "randomize_order": false,
  "required": true
}
// Data would be saved as: "statement_ratings": {
//   "Statement 1": 50,
//   "Statement 2": 50,
//   "Statement 3": 50
// }</code></pre>
        <h5 class="text-base font-semibold text-gray-600 mt-4 mb-2">Example with <code>sampling_size</code>:</h5>
        <pre><code>{
  "prompt": "Please rate the following statements about the agent's initial beliefs:",
  "type": "multi-slider",
  "tag": "statement_rating",
  "option": [
    "The player initially believed that box 3 contained a blue key.",
    "The player initially believed that box 1 and 2 contained no blue key.",
    "The player initially believed that box 1 might have the blue key.",
    "The player initially believed the blue key was not in box 2.",
    "The player initially thought that there may have been a key in box 2."
  ],
  "slider_config": {
    "min": 1,
    "max": 7,
    "default_value": 4,
    "labels": [
      { "value": 1, "label": "Extremely unlikely" },
      { "value": 7, "label": "Extremely likely" }
    ],
    "show_label_values": true
  },
  "sampling_size": 2,
  "randomize_order": true,
  "required": true
}
// With sampling_size: 2, only 2 randomly selected statements will be shown to each participant
// Data would be saved as: "statement_rating": {
//   "The player initially believed that box 3 contained a blue key.": 5,
//   "The player initially thought that there may have been a key in box 2.": 3
// }</code></pre>
        <h5 class="text-base font-semibold text-gray-600 mt-4 mb-2">Live Demo:</h5>
        <div class="rendered-example bg-gray-100 p-4 rounded-md mb-8 border border-gray-200 not-prose">
            <p class="font-medium mb-3">Please rate how likely each of the following statements is to be true<span class="required-asterisk">*</span></p>
            <div class="space-y-6">
                <div>
                    <p class="text-sm text-gray-700 mb-2">Statement 1: <span id="multi-slider-val-1" class="font-semibold">50</span></p>
                    <div class="slider-wrapper">
                        <input type="range" min="0" max="100" value="50" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer" oninput="document.getElementById('multi-slider-val-1').innerText = this.value">
                        <div class="slider-labels">
                            <span class="slider-label-item" style="left: 0%; transform: translateX(0%);">0<br>Extremely unlikely</span>
                            <span class="slider-label-item" style="left: 50%; transform: translateX(-50%);">50<br>Neutral</span>
                            <span class="slider-label-item" style="left: 100%; transform: translateX(-100%);">100<br>Extremely likely</span>
                        </div>
                    </div>
                </div>
                <div>
                    <p class="text-sm text-gray-700 mb-2">Statement 2: <span id="multi-slider-val-2" class="font-semibold">50</span></p>
                    <div class="slider-wrapper">
                        <input type="range" min="0" max="100" value="50" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer" oninput="document.getElementById('multi-slider-val-2').innerText = this.value">
                        <div class="slider-labels">
                            <span class="slider-label-item" style="left: 0%; transform: translateX(0%);">0<br>Extremely unlikely</span>
                            <span class="slider-label-item" style="left: 50%; transform: translateX(-50%);">50<br>Neutral</span>
                            <span class="slider-label-item" style="left: 100%; transform: translateX(-100%);">100<br>Extremely likely</span>
                        </div>
                    </div>
                </div>
                <div>
                    <p class="text-sm text-gray-700 mb-2">Statement 3: <span id="multi-slider-val-3" class="font-semibold">50</span></p>
                    <div class="slider-wrapper">
                        <input type="range" min="0" max="100" value="50" class="w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer" oninput="document.getElementById('multi-slider-val-3').innerText = this.value">
                        <div class="slider-labels">
                            <span class="slider-label-item" style="left: 0%; transform: translateX(0%);">0<br>Extremely unlikely</span>
                            <span class="slider-label-item" style="left: 50%; transform: translateX(-50%);">50<br>Neutral</span>
                            <span class="slider-label-item" style="left: 100%; transform: translateX(-100%);">100<br>Extremely likely</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <h4 class="prose">3.2.1.5. textbox</h4>
        <p class="prose">Provides a free-response text area for the user to type in an answer. The <code>option</code> field is not used.</p>
        <h5 class="text-base font-semibold text-gray-600 mt-4 mb-2">JSON Example:</h5>
        <pre><code>{
  "prompt": "Please describe the agent's behavior.",
  "type": "textbox",
  "tag": "agent_description",
  "required": true
}
// Data would be saved as: "agent_description": "The agent moved..."</code></pre>
        <h5 class="text-base font-semibold text-gray-600 mt-4 mb-2">Live Demo:</h5>
        <div class="rendered-example bg-gray-100 p-4 rounded-md mb-8 border border-gray-200 not-prose">
            <label for="agent_description_demo" class="font-medium mb-3 block">Please describe the agent's behavior.<span class="required-asterisk">*</span></label>
            <textarea id="agent_description_demo" rows="3" class="w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"></textarea>
    </div>


        <h3 id="slider-config">3.2.2. Slider Config (<code>slider_config</code>)</h3>
        <p>This object is required for <code>single-slider</code> and <code>multi-slider</code> types.</p>
        <div class="overflow-x-auto">
            <table>
                <thead>
                    <tr>
                        <th>Key</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>min</code></td>
                        <td>Number</td>
                        <td>The minimum value of the slider (e.g., 0).</td>
                    </tr>
                    <tr>
                        <td><code>max</code></td>
                        <td>Number</td>
                        <td>The maximum value of the slider (e.g., 100).</td>
                    </tr>
                    <tr>
                        <td><code>default_value</code></td>
                        <td>Number</td>
                        <td>The value where the slider handle starts.</td>
                    </tr>
                    <tr>
                        <td><code>labels</code></td>
                        <td>Array of Objects</td>
                        <td>An array of label objects to display under the slider. See table below.</td>
                    </tr>
                    <tr>
                        <td><code>show_label_values</code></td>
                        <td>Boolean</td>
                        <td>If <code>true</code>, displays the numeric value (from <code>value</code>) alongside the text (from <code>label</code>).</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <p class="prose my-4">Each object in the <code>labels</code> array has the following structure:</p>
        <div class="overflow-x-auto">
            <table>
                <thead>
                    <tr>
                        <th>Key</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>value</code></td>
                        <td>Number</td>
                        <td>The numeric position on the slider where this label should appear.</td>
                    </tr>
                    <tr>
                        <td><code>label</code></td>
                        <td>String</td>
                        <td>The text to display at that position (e.g., "Neutral", "Strongly Agree").</td>
                    </tr>
                </tbody>
            </table>
        </div>
        </div>
    </div>

</body>
</html>